<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="description" content="Sentry is an open source  Application Monitoring Service for app crashes. It’s also free self-hosted available."><meta name="keyword" content="APM,DevOps,High Availability,Sentry,System Design"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>An breif introduction on self-hosted sentry</title><link rel="icon" href="data:image/svg+xml,%3Csvg width='24' height='28' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext font-size='24' y='24'%3E諺%3C/text%3E%3C/svg%3E" type="image/x-icon"><link href="/styles/site.css" rel="stylesheet"><script async src="https://eu.umami.is/script.js" data-website-id="449a84b6-be9e-49de-a4cc-e0fa6fea1df9"></script><meta name="generator" content="Hexo 6.3.0"></head><body><header><div class="header no-print"><div class="header-container"><div class="header-left"><a href="/">諺</a></div><ul class="header-right"><li><a href="/archives">Archives</a></li><li><a href="/tags" rel="nofollow">Tags</a></li><li><a href="/about" rel="nofollow">About</a></li><li><a href="/epistemology" rel="nofollow">認識論</a></li><li><a href="/books" rel="nofollow">読書</a></li><li><a href="/archives" rel="nofollow">zh</a><a href="#" rel="nofollow">/</a><a href="/en" rel="nofollow">en</a></li></ul></div></div></header><div class="container"><div class="content-wrapper"><div class="post"><section class="article"><div class="title">An breif introduction on self-hosted sentry</div><div class="date no-print">2021-09-09 / modified at 2022-06-30 / 456 words / 2 mins</div><div class="content"><blockquote><span>️This article has been <strong>over 3 years</strong> since the last update.</span></blockquote><p>Sentry is an open source Application Monitoring Service for app crashes. It’s also free self-hosted available.</p><span id="more"></span><h2>When need self-hosted</h2><ul><li>You have machines on private cloud with deep pockets.</li><li>You believe you can implement a cheaper solution than the official price.</li><li>Someone can maintain following PaaS/IaaS/SaaS service</li><li>Someone can maintain the complex components.</li></ul><h2>What is BSL(Business Source License) license</h2><p>Why BSL?</p><p>See <a target="_blank" rel="noopener" href="https://blog.sentry.io/2019/11/06/relicensing-sentry">here</a> since Nov 7, 2019</p><blockquote><p>These businesses are not using Sentry to improve how they develop software; they’re lifting its code and assets to build their closed-source products to compete directly with us.</p></blockquote><p>And see twitter</p><blockquote><p>Nearly 100% of Sentry is written by full time employees of Sentry. It’s not a typical open source project.</p></blockquote><p>What you can do</p><blockquote><p>The BSL lets us hit our goals in a clean and low-impact way: it won’t change anyone’s ability to run Sentry at their company</p></blockquote><p>Here is a summary</p><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="MINDMAP" height="416px" preserveAspectRatio="none" style="width:823px;height:416px;background:#fff" version="1.1" viewBox="0 0 823 416" width="823px" zoomAndPan="magnify" class="kroki">$2<defs/><g><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="65.9033" x="10" y="188.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.9033" x="20" y="211.8857">Sentry</text><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="248.6621" x="125.9033" y="20"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="228.6621" x="135.9033" y="42.9951">Client SDK(MIT/Apache licensed)</text><path d="M75.9033,207.0391 L85.9033,207.0391 C100.9033,207.0391 100.9033,38.1484 115.9033,38.1484 L125.9033,38.1484" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="52.5938" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="119.4219" x="125.9033" y="208.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.6455" x="135.9033" y="231.8857">Server-side</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.4219" x="135.9033" y="248.1826">(BSL licensed)</text><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="47.2275" x="295.3252" y="76.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27.2275" x="305.3252" y="99.292">Can</text><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="275.2334" x="392.5527" y="76.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255.2334" x="402.5527" y="99.292">Internal use(employees/contractors)</text><path d="M342.5527,94.4453 L352.5527,94.4453 C367.5527,94.4453 367.5527,94.4453 382.5527,94.4453 L392.5527,94.4453" fill="none" style="stroke:#454645;stroke-width:1"/><path d="M245.3252,235.1875 L255.3252,235.1875 C270.3252,235.1875 270.3252,94.4453 285.3252,94.4453 L295.3252,94.4453" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="56.5654" x="295.3252" y="188.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.5654" x="305.3252" y="211.8857">Can't</text><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="251.0957" x="401.8906" y="132.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="231.0957" x="411.8906" y="155.5889">AWS stealing sentry source-code</text><path d="M351.8906,207.0391 L361.8906,207.0391 C376.8906,207.0391 376.8906,150.7422 391.8906,150.7422 L401.8906,150.7422" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="243.2275" x="401.8906" y="188.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="223.2275" x="411.8906" y="211.8857">directly repack and sell as SaaS</text><path d="M351.8906,207.0391 L361.8906,207.0391 C376.8906,207.0391 376.8906,207.0391 391.8906,207.0391 L401.8906,207.0391" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="238.8184" x="401.8906" y="245.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="218.8184" x="411.8906" y="268.1826">Bundling APM for its customers</text><path d="M351.8906,207.0391 L361.8906,207.0391 C376.8906,207.0391 376.8906,263.3359 391.8906,263.3359 L401.8906,263.3359" fill="none" style="stroke:#454645;stroke-width:1"/><path d="M245.3252,235.1875 L255.3252,235.1875 C270.3252,235.1875 270.3252,207.0391 285.3252,207.0391 L295.3252,207.0391" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="79.5137" x="295.3252" y="329.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.5137" x="305.3252" y="352.6279">Not sure</text><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="342.0342" x="424.8389" y="301.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="322.0342" x="434.8389" y="324.4795">A hotel-reserve app bundle Sentry with SaaS?</text><path d="M374.8389,347.7813 L384.8389,347.7813 C399.8389,347.7813 399.8389,319.6328 414.8389,319.6328 L424.8389,319.6328" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="386.2832" x="424.8389" y="357.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="366.2832" x="434.8389" y="380.7764">A hotel-reserve app bundle Sentry with on-premise?</text><path d="M374.8389,347.7813 L384.8389,347.7813 C399.8389,347.7813 399.8389,375.9297 414.8389,375.9297 L424.8389,375.9297" fill="none" style="stroke:#454645;stroke-width:1"/><path d="M245.3252,235.1875 L255.3252,235.1875 C270.3252,235.1875 270.3252,347.7813 285.3252,347.7813 L295.3252,347.7813" fill="none" style="stroke:#454645;stroke-width:1"/><path d="M75.9033,207.0391 L85.9033,207.0391 C100.9033,207.0391 100.9033,235.1875 115.9033,235.1875 L125.9033,235.1875" fill="none" style="stroke:#454645;stroke-width:1"/></g></svg><p>It’s highly recommended to bundle your business product with vendor neutrral SDK such as OpenTelemetry/Prometheus.</p><h2>GDPR?</h2><p>Yes</p><h2>APM Comparison</h2><details><summary>Click to show</summary><p>Compared at Sep 10, 2021</p><table><thead><tr><th style="text-align:left">APM</th><th style="text-align:left">Sentry</th><th style="text-align:left">SigNoz</th></tr></thead><tbody><tr><td style="text-align:left">Self-hosted</td><td style="text-align:left">Y</td><td style="text-align:left">Y</td></tr><tr><td style="text-align:left">standards</td><td style="text-align:left">Open-sourced</td><td style="text-align:left">OpenTelemetry</td></tr><tr><td style="text-align:left">Server License</td><td style="text-align:left">BSL</td><td style="text-align:left">MIT</td></tr><tr><td style="text-align:left">SDK License</td><td style="text-align:left">Apache2.0</td><td style="text-align:left">Apache2.0</td></tr><tr><td style="text-align:left">backend</td><td style="text-align:left">python</td><td style="text-align:left">go</td></tr><tr><td style="text-align:left">ClickHouse</td><td style="text-align:left">Y</td><td style="text-align:left">Y</td></tr><tr><td style="text-align:left">distributed tracing</td><td style="text-align:left">Y</td><td style="text-align:left">Y</td></tr><tr><td style="text-align:left">logging</td><td style="text-align:left">Y</td><td style="text-align:left">Not all</td></tr><tr><td style="text-align:left">Community</td><td style="text-align:left">Widely &amp; stable</td><td style="text-align:left">Startup</td></tr><tr><td style="text-align:left">Team size</td><td style="text-align:left">100+</td><td style="text-align:left">&lt;10</td></tr><tr><td style="text-align:left">RBAC</td><td style="text-align:left">Y</td><td style="text-align:left">N</td></tr><tr><td style="text-align:left">Complexity</td><td style="text-align:left">High</td><td style="text-align:left">Low</td></tr><tr><td style="text-align:left">Custom Metric</td><td style="text-align:left">Out of the box</td><td style="text-align:left">By Raw Query</td></tr></tbody></table><p>All you need to do is to find a balance between the complexity and out-of-the-box features.</p></details><h2>Architecture</h2><p><a target="_blank" rel="noopener" href="https://develop.sentry.dev/architecture/">https://develop.sentry.dev/architecture/</a></p><p>Here is the requirement when self-hosted</p><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="MINDMAP" height="570px" preserveAspectRatio="none" style="width:693px;height:570px;background:#fff" version="1.1" viewBox="0 0 693 570" width="693px" zoomAndPan="magnify" class="kroki">$2<defs/><g><rect fill="#D3D3D3" height="52.5938" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="71.7412" x="321.084" y="257.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.9033" x="331.084" y="280.7764">Sentry</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.7412" x="331.084" y="297.0732">Service</text><rect fill="#FFFFCC" height="52.5938" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="80.498" x="442.8252" y="157.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.3105" x="452.8252" y="180.0342">sentry</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.498" x="452.8252" y="196.3311">(Django)</text><rect fill="#FFFFCC" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="51.3428" x="573.3232" y="137.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.3428" x="583.3232" y="160.0342">Web</text><path d="M523.3232,183.3359 L533.3232,183.3359 C548.3232,183.3359 548.3232,155.1875 563.3232,155.1875 L573.3232,155.1875" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#FFFFCC" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="108.3271" x="573.3232" y="193.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.3271" x="583.3232" y="216.3311">Cron/Worker</text><path d="M523.3232,183.3359 L533.3232,183.3359 C548.3232,183.3359 548.3232,211.4844 563.3232,211.4844 L573.3232,211.4844" fill="none" style="stroke:#454645;stroke-width:1"/><path d="M392.8252,284.0781 L402.8252,284.0781 C417.8252,284.0781 417.8252,183.3359 432.8252,183.3359 L442.8252,183.3359" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#FFFFCC" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="153.4307" x="442.8252" y="249.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133.4307" x="452.8252" y="272.6279">relay(event digest)</text><path d="M392.8252,284.0781 L402.8252,284.0781 C417.8252,284.0781 417.8252,267.7813 432.8252,267.7813 L442.8252,267.7813" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#FFFFCC" height="52.5938" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="190.502" x="442.8252" y="305.9297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.5059" x="452.8252" y="328.9248">snuba</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170.502" x="452.8252" y="345.2217">(wrapper for clickhouse)</text><path d="M392.8252,284.0781 L402.8252,284.0781 C417.8252,284.0781 417.8252,332.2266 432.8252,332.2266 L442.8252,332.2266" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#FFFFCC" height="52.5938" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="178.1973" x="442.8252" y="378.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158.1973" x="452.8252" y="401.5186">symbolicator(optional)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141.6064" x="452.8252" y="417.8154">(reverse stacktrace)</text><path d="M392.8252,284.0781 L402.8252,284.0781 C417.8252,284.0781 417.8252,404.8203 432.8252,404.8203 L442.8252,404.8203" fill="none" style="stroke:#454645;stroke-width:1"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35.957" x="232.127" y="188.1826">Third</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34.4873" x="232.127" y="204.4795">PaaS</text><rect fill="#90EE90" height="52.5938" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="152.1318" x="29.9951" y="20"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.1416" x="39.9951" y="42.9951">ClickHouse/Tabix</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.1318" x="39.9951" y="59.292">(for event storage)</text><path d="M232.127,191.4844 L222.127,191.4844 C207.127,191.4844 207.127,46.2969 192.127,46.2969 L182.127,46.2969" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#90EE90" height="52.5938" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="151.0586" x="31.0684" y="92.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.7529" x="41.0684" y="115.5889">PostgreSQL</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131.0586" x="41.0684" y="131.8857">(project/user data)</text><path d="M232.127,191.4844 L222.127,191.4844 C207.127,191.4844 207.127,118.8906 192.127,118.8906 L182.127,118.8906" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#90EE90" height="52.5938" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="142.0078" x="40.1191" y="165.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.5479" x="50.1191" y="188.1826">Kafka/zk</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122.0078" x="50.1191" y="204.4795">(for event digest)</text><path d="M232.127,191.4844 L222.127,191.4844 C207.127,191.4844 207.127,191.4844 192.127,191.4844 L182.127,191.4844" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#90EE90" height="52.5938" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="172.127" x="10" y="237.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.4111" x="20" y="260.7764">Redis</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152.127" x="20" y="277.0732">(transactional/Celery)</text><path d="M232.127,191.4844 L222.127,191.4844 C207.127,191.4844 207.127,264.0781 192.127,264.0781 L182.127,264.0781" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#90EE90" height="52.5938" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="158.6738" x="23.4531" y="310.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138.6738" x="33.4531" y="333.3701">RabbitMQ(Optional)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129.6914" x="33.4531" y="349.667">(for Celery broker)</text><path d="M232.127,191.4844 L222.127,191.4844 C207.127,191.4844 207.127,336.6719 192.127,336.6719 L182.127,336.6719" fill="none" style="stroke:#454645;stroke-width:1"/><path d="M321.084,284.0781 L311.084,284.0781 C296.084,284.0781 296.084,191.4844 281.084,191.4844 L271.084,191.4844" fill="none" style="stroke:#454645;stroke-width:1"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35.957" x="232.127" y="434.1123">Third</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.1738" x="232.127" y="450.4092">IaaS</text><rect fill="#ADD8E6" height="52.5938" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="148.29" x="33.8369" y="382.9688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.2217" x="43.8369" y="405.9639">FileStorage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128.29" x="43.8369" y="422.2607">(S3/PV/NFS/MinIO)</text><path d="M232.127,437.4141 L222.127,437.4141 C207.127,437.4141 207.127,409.2656 192.127,409.2656 L182.127,409.2656" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#ADD8E6" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="145.248" x="36.8789" y="455.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125.248" x="46.8789" y="478.5576">ALB/Nginx/Traefik</text><path d="M232.127,437.4141 L222.127,437.4141 C207.127,437.4141 207.127,473.7109 192.127,473.7109 L182.127,473.7109" fill="none" style="stroke:#454645;stroke-width:1"/><path d="M321.084,284.0781 L311.084,284.0781 C296.084,284.0781 296.084,437.4141 281.084,437.4141 L271.084,437.4141" fill="none" style="stroke:#454645;stroke-width:1"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35.957" x="232.127" y="526.7061">Third</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34.9316" x="232.127" y="543.0029">SaaS</text><rect fill="#FAF0E6" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="81.9473" x="100.1797" y="511.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.9473" x="110.1797" y="534.8545">SSO/Mail</text><path d="M232.127,530.0078 L222.127,530.0078 C207.127,530.0078 207.127,530.0078 192.127,530.0078 L182.127,530.0078" fill="none" style="stroke:#454645;stroke-width:1"/><path d="M321.084,284.0781 L311.084,284.0781 C296.084,284.0781 296.084,530.0078 281.084,530.0078 L271.084,530.0078" fill="none" style="stroke:#454645;stroke-width:1"/></g></svg><h4>What is Sentry</h4><ul><li>Web App</li><li>Asynchronous/Cron Workers</li></ul><h4>What is Relay</h4><p>It mostly acts like as a event digest, reads HTTP requests and sends events to kafka.</p><p>see flow <a target="_blank" rel="noopener" href="https://getsentry.github.io/event-ingestion-graph/">site</a></p><p>Architecture see at <a target="_blank" rel="noopener" href="https://getsentry.github.io/relay/relay_server/index.html#path-of-an-event-through-relay">here</a></p><h4>What is Snuba</h4><p><a target="_blank" rel="noopener" href="https://getsentry.github.io/snuba/">https://getsentry.github.io/snuba/</a></p><p>Similar to Apache Phoenix/Redash/Tabix, a CRUD wrapper for clickhouse</p><h2>Scalability &amp; High availability Operations</h2><p>Here is what we need to concert when deployed.</p><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="MINDMAP" height="528px" preserveAspectRatio="none" style="width:404px;height:528px;background:#fff" version="1.1" viewBox="0 0 404 528" width="404px" zoomAndPan="magnify" class="kroki">$2<defs/><g><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="40.1045" x="10" y="245.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.1045" x="20" y="268.1826">HA</text><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="69.8203" x="100.1045" y="48.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49.8203" x="110.1045" y="71.1436">Quotas</text><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="98.8594" x="219.9248" y="20"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.8594" x="229.9248" y="42.9951">Rate Limits</text><path d="M169.9248,66.2969 L179.9248,66.2969 C194.9248,66.2969 194.9248,38.1484 209.9248,38.1484 L219.9248,38.1484" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="108.498" x="219.9248" y="76.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.498" x="229.9248" y="99.292">Bigger Redis</text><path d="M169.9248,66.2969 L179.9248,66.2969 C194.9248,66.2969 194.9248,94.4453 209.9248,94.4453 L219.9248,94.4453" fill="none" style="stroke:#454645;stroke-width:1"/><path d="M50.1045,263.3359 L60.1045,263.3359 C75.1045,263.3359 75.1045,66.2969 90.1045,66.2969 L100.1045,66.2969" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="98.3604" x="100.1045" y="132.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.3604" x="110.1045" y="155.5889">Hot update</text><path d="M50.1045,263.3359 L60.1045,263.3359 C75.1045,263.3359 75.1045,150.7422 90.1045,150.7422 L100.1045,150.7422" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="128.9512" x="100.1045" y="188.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.9512" x="110.1045" y="211.8857">event not losed</text><path d="M50.1045,263.3359 L60.1045,263.3359 C75.1045,263.3359 75.1045,207.0391 90.1045,207.0391 L100.1045,207.0391" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="112.7021" x="100.1045" y="245.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.7021" x="110.1045" y="268.1826">web avaliabe</text><path d="M50.1045,263.3359 L60.1045,263.3359 C75.1045,263.3359 75.1045,263.3359 90.1045,263.3359 L100.1045,263.3359" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="71.748" x="100.1045" y="329.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.748" x="110.1045" y="352.6279">Backup</text><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="170.6572" x="221.8525" y="301.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150.6572" x="231.8525" y="324.4795">project and user data</text><path d="M171.8525,347.7813 L181.8525,347.7813 C196.8525,347.7813 196.8525,319.6328 211.8525,319.6328 L221.8525,319.6328" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="51.7393" x="221.8525" y="357.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.7393" x="231.8525" y="380.7764">Files</text><path d="M171.8525,347.7813 L181.8525,347.7813 C196.8525,347.7813 196.8525,375.9297 211.8525,375.9297 L221.8525,375.9297" fill="none" style="stroke:#454645;stroke-width:1"/><path d="M50.1045,263.3359 L60.1045,263.3359 C75.1045,263.3359 75.1045,347.7813 90.1045,347.7813 L100.1045,347.7813" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="63.0664" x="100.1045" y="442.2266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43.0664" x="110.1045" y="465.2217">Check</text><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="110.6855" x="213.1709" y="414.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.6855" x="223.1709" y="437.0732">Health Probe</text><path d="M163.1709,460.375 L173.1709,460.375 C188.1709,460.375 188.1709,432.2266 203.1709,432.2266 L213.1709,432.2266" fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="104.1572" x="213.1709" y="470.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.1572" x="223.1709" y="493.3701">Prometheus</text><path d="M163.1709,460.375 L173.1709,460.375 C188.1709,460.375 188.1709,488.5234 203.1709,488.5234 L213.1709,488.5234" fill="none" style="stroke:#454645;stroke-width:1"/><path d="M50.1045,263.3359 L60.1045,263.3359 C75.1045,263.3359 75.1045,460.375 90.1045,460.375 L100.1045,460.375" fill="none" style="stroke:#454645;stroke-width:1"/></g></svg><p><a target="_blank" rel="noopener" href="https://develop.sentry.dev/self-hosted/backup/">https://develop.sentry.dev/self-hosted/backup/</a></p></div><div class="tags"><a class="tag-link" href="/tags/APM/" rel="tag">APM</a><a class="tag-link" href="/tags/DevOps/" rel="tag">DevOps</a><a class="tag-link" href="/tags/High-Availability/" rel="tag">High Availability</a><a class="tag-link" href="/tags/Sentry/" rel="tag">Sentry</a><a class="tag-link" href="/tags/System-Design/" rel="tag">System Design</a></div></section><div class="comments no-print"><noscript>Please enable JavaScript to view comments.</noscript><script async src="https://giscus.app/client.js" data-repo="miao1007/miao1007.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkxMzA1NTY1MDU=" data-category="General" data-category-id="DIC_kwDOB8giWc4COaTx" data-mapping="url" data-reactions-enabled="0" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="en" data-loading="lazy" crossorigin="anonymous"></script></div></div></div><footer class="no-print"><div class="rights"><a href="/feed.xml" rel="external nofollow">RSS</a><span>, Theme </span><a href="https://github.com/gary-Shen/hexo-theme-bear" rel="external nofollow" target="_blank">Curry.</a><span> All contents are not allowed to be redistributed or synthesised without an explicit permission.</span></div></footer></div></body></html>