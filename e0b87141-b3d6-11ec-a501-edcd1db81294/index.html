<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="description" content="随着开源软件的兴起，传统的芯片领域也不断地被侵蚀，本文简要介绍利用开源工具实现数字电路到BES综合的流程。"><meta name="keyword" content="RISC-V"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>自己编译开源RISC-V CPU</title><link rel="icon" href="data:image/svg+xml,%3Csvg width='24' height='28' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext font-size='24' y='24'%3E諺%3C/text%3E%3C/svg%3E" type="image/x-icon"><link href="/styles/site.css" rel="stylesheet"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-102296742-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-102296742-1")</script><meta name="generator" content="Hexo 5.4.0"></head><body><header><div class="header no-print"><div class="header-container"><div class="header-left"><a href="/">諺</a></div><ul class="header-right"><li><a href="/archives">Archives</a></li><li><a href="/tags" rel="nofollow">Tags</a></li><li><a href="/about" rel="nofollow">About</a></li><li><a href="/epistemology" rel="nofollow">認識論</a></li><li><a href="/books" rel="nofollow">読書</a></li><li><a href="/archives" rel="nofollow">zh</a><a href="#" rel="nofollow">/</a><a href="/en" rel="nofollow">en</a></li></ul></div></div></header><div class="container"><div class="content-wrapper"><div class="post"><section class="article"><div class="title">自己编译开源RISC-V CPU</div><div class="date">2021-05-19 / modified at 2023-02-20</div><div class="content"><p>随着开源软件的兴起，传统的芯片领域也不断地被侵蚀，本文简要介绍利用开源工具实现数字电路到BES综合的流程。</p><span id="more"></span><h2>背景</h2><p>芯片开发与软件中的CURD写Controller类似，并没有&quot;全栈&quot;的任务，相反每个人反而更加原子化。未来随着开源化，芯片设计同样将廉价化，造芯片将和造车一样遍地都是。</p><p>本文介绍的流程</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Chisel --(sbt)--&gt; RTL --(syn)--&gt; Netlist --(后端)---&gt; 后端暂时不介绍</span><br></pre></td></tr></table></figure><p>详细流程</p> <?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="310px" preserveAspectRatio="none" style="width:694px;height:310px;background:#fff" version="1.1" viewBox="0 0 694 310" width="694px" zoomAndPan="magnify" class="kroki">$2<defs/><g><g id="cluster_syn"><rect fill="none" height="123" rx="3.5" ry="3.5" style="stroke:#696969;stroke-width:1" width="200" x="364" y="78"/><path d="M402,78 L402,87.2969 L392,97.2969 L364,97.2969 " fill="none" style="stroke:#696969;stroke-width:1"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="28" x="367" y="91.9951">syn</text></g><g id="cluster_chisel"><rect fill="none" height="194" rx="3.5" ry="3.5" style="stroke:#696969;stroke-width:1" width="134" x="62" y="7"/><path d="M118,7 L118,16.2969 L108,26.2969 L62,26.2969 " fill="none" style="stroke:#696969;stroke-width:1"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="46" x="65" y="20.9951">chisel</text></g><g id="elem_library"><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:.5" width="152" x="388" y="120.85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132" x="398" y="143.8451">standard cell library</text></g><g id="elem_build"><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:.5" width="79" x="89.5" y="120.85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="99.5" y="143.8451">build.sbt</text></g><g id="elem_scala"><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:.5" width="86" x="86" y="49.85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="96" y="72.8451">scala files</text></g><g id="elem_user"><ellipse cx="129" cy="237.35" fill="#454645" rx="8" ry="8" style="stroke:#454645;stroke-width:.5"/><path d="M129,245.35 L129,272.35 M116,253.35 L142,253.35 M129,272.35 L116,287.35 M129,272.35 L142,287.35 " fill="none" style="stroke:#454645;stroke-width:.5"/><text fill="#454645" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="94.5" y="301.8451">developer</text></g><g id="elem_top"><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:.5" width="58" x="251" y="174.85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="261" y="197.8451">Top.v</text></g><g id="elem_netlist"><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:.5" width="69" x="619" y="174.85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="629" y="197.8451">synth.v</text></g><g id="link_user_scala"><path d="M94.18,249.35 C59.88,229.2 13.93,193.29 23.83,149.5 C28.88,127.17 29.44,118.82 46,103 C55.7,93.74 68.21,86.75 80.56,81.56 " fill="none" id="user-to-scala" style="stroke:#454645;stroke-width:1"/><polygon fill="#454645" points="84.84,79.44,74.9981,79.0686,80.1976,81.297,77.9693,86.4964,84.84,79.44" style="stroke:#454645;stroke-width:1"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="7" y="162.5669">write</text></g><g id="link_chisel_top"><path d="M196.2776,193 C196.6677,193 197.0581,193 197.4487,193 C198.23,193 199.0124,193 199.7954,193 C202.9276,193 206.0709,193 209.2031,193 C221.7319,193 234.0825,193 244.83,193 " fill="none" id="chisel-to-top" style="stroke:#454645;stroke-width:1"/><polygon fill="#454645" points="249.72,193,240.72,189,244.72,193,240.72,197,249.72,193" style="stroke:#454645;stroke-width:1"/></g><g id="link_top_syn"><path d="M309.44,193 C322.0375,193 337.7344,193 354.2423,193 C356.3058,193 358.382,193 360.4664,193 C361.5086,193 362.5528,193 363.5985,193 " fill="none" id="top-to-syn" style="stroke:#454645;stroke-width:1"/><polygon fill="#454645" points="363.5985,193,354.5985,189,358.5985,193,354.5985,197,363.5985,193" style="stroke:#454645;stroke-width:1"/></g><g id="link_syn_netlist"><path d="M564.6625,193 C565.6688,193 566.6741,193 567.6781,193 C583.7419,193 599.4525,193 612.9,193 " fill="none" id="syn-to-netlist" style="stroke:#454645;stroke-width:1"/><polygon fill="#454645" points="617.63,193,608.63,189,612.63,193,608.63,197,617.63,193" style="stroke:#454645;stroke-width:1"/></g></g></svg><h2>前端数字设计</h2><h4>准备工作</h4><p>我们以这个标准的scala项目为例</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/jlpteaching/dinocpu.git</span><br></pre></td></tr></table></figure><p>然后安装</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install sbt scala</span><br></pre></td></tr></table></figure><p>若需要配置SBT镜像库，详见<a target="_blank" rel="noopener" href="https://mirrors.huaweicloud.com/">mirrors</a></p><h4>编译构建</h4><p>如下将下载Chisel等依赖，并在根目录生成Top.v</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sbt <span class="string">&quot;runMain dinocpu.elaborate single-cycle&quot;</span></span><br><span class="line"><span class="comment"># or </span></span><br><span class="line">sbt <span class="string">&quot;runMain dinocpu.elaborate pipelined&quot;</span></span><br></pre></td></tr></table></figure><p>Chisel的定位类似预综合，可以降低Verilog的编写门槛。</p><h2>综合(synthesis)</h2><p>参考 <a target="_blank" rel="noopener" href="http://www.clifford.at/yosys/files/yosys_presentation.pdf">http://www.clifford.at/yosys/files/yosys_presentation.pdf</a></p><p>简单介绍：RTL代码 + Cell库 -&gt; 网表</p><svg xmlns="http://www.w3.org/2000/svg" class="pikchr" width="348" height="156" viewBox="0 0 465.166 209.574" class="kroki">$2<path d="M3,110L75,110L75,23L53,2L3,2Z" style="fill:none;stroke-width:2.16;stroke:#000"/><path d="M53,2L53,23L75,23" style="fill:none;stroke-width:2.16;stroke:#000"/><text x="39" y="56" text-anchor="middle" fill="rgb(0,0,0)" font-size="110%" dominant-baseline="central">verilogs</text><polygon points="183,56 171,60 171,51" style="fill:#000"/><path d="M75,56L177,56" style="fill:none;stroke-width:2.16;stroke:#000"/><text x="129" y="41" text-anchor="middle" fill="rgb(0,0,0)" font-size="110%" dominant-baseline="central">read</text><text x="129" y="70" text-anchor="middle" fill="rgb(0,0,0)" font-size="110%" dominant-baseline="central">design</text><path d="M198,88L266,88A15 15 0 0 0 281 73L281,39A15 15 0 0 0 266 24L198,24A15 15 0 0 0 183 39L183,73A15 15 0 0 0 198 88Z" style="fill:none;stroke-width:2.16;stroke:#000"/><text x="232" y="43" text-anchor="middle" fill="rgb(0,0,0)" font-size="110%" dominant-baseline="central">synthesis</text><text x="232" y="68" text-anchor="middle" fill="rgb(0,0,0)" font-size="110%" dominant-baseline="central">(yosys)</text><polygon points="389,56 378,60 378,51" style="fill:#000"/><path d="M281,56L383,56" style="fill:none;stroke-width:2.16;stroke:#000"/><text x="335" y="41" text-anchor="middle" fill="rgb(0,0,0)" font-size="110%" dominant-baseline="central">link</text><text x="335" y="70" text-anchor="middle" fill="rgb(0,0,0)" font-size="110%" dominant-baseline="central">opt</text><path d="M389,110L461,110L461,23L440,2L389,2Z" style="fill:none;stroke-width:2.16;stroke:#000"/><path d="M440,2L440,23L461,23" style="fill:none;stroke-width:2.16;stroke:#000"/><text x="425" y="56" text-anchor="middle" fill="rgb(0,0,0)" font-size="110%" dominant-baseline="central">netlist.v</text><polygon points="232,88 236,99 228,99" style="fill:#000"/><path d="M232,93L232,122" style="fill:none;stroke-width:2.16;stroke:#000"/><path d="M183,133L183,196A48 10 0 0 0 281 196L281,133A48 10 0 0 0 183 133A48 10 0 0 0 281 133" style="fill:none;stroke-width:2.16;stroke:#000"/><text x="232" y="160" text-anchor="middle" fill="rgb(0,0,0)" font-size="110%" dominant-baseline="central">Standard</text><text x="232" y="185" text-anchor="middle" fill="rgb(0,0,0)" font-size="110%" dominant-baseline="central">Cell</text></svg><h4>安装yosys</h4><p>直接brew安装即可</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install yosys</span><br></pre></td></tr></table></figure><h4>什么是 standard cell库</h4><p>电路的各种物理约束，大部分是闭源格式，你应该找EDA厂商/Fab厂商去要</p><blockquote><p>这些Cell与具体的工艺、厂商、IP绑定。比如台积电会优先与Synopsys共同开发新的5nm的lib库，而你没有这种库的话，从综合这一步开始就要被“卡脖子”了。</p></blockquote><p>开源的格式类似于yaml，详见https://www.physicaldesigninsight.com/post/liberty-file-format</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载lib库(standard cell library)</span></span><br><span class="line">wget https://raw.githubusercontent.com/YosysHQ/yosys/master/manual/PRESENTATION_Intro/mycells.lib</span><br></pre></td></tr></table></figure><h4>综合命令</h4><p>如下是综合脚本，与官网一致</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># read design </span></span><br><span class="line">read_verilog Top.v</span><br><span class="line"></span><br><span class="line"><span class="comment"># elaborate design hierarchy</span></span><br><span class="line">hierarchy -check -top Top</span><br><span class="line"></span><br><span class="line"><span class="comment"># the high-level stuff</span></span><br><span class="line">proc; opt; fsm; opt; memory; opt</span><br><span class="line"></span><br><span class="line"><span class="comment"># mapping to internal cell library</span></span><br><span class="line">techmap; opt</span><br><span class="line"></span><br><span class="line"><span class="comment"># mapping flip-flops to mycells.lib</span></span><br><span class="line">dfflibmap -liberty mycells.lib</span><br><span class="line"></span><br><span class="line"><span class="comment"># mapping logic to mycells.lib</span></span><br><span class="line"><span class="comment"># 需要数个小时，真正的BES开发要同时跑多个design，不能干等</span></span><br><span class="line">abc -liberty mycells.lib</span><br><span class="line"></span><br><span class="line"><span class="comment"># cleanup</span></span><br><span class="line">clean</span><br><span class="line"></span><br><span class="line"><span class="comment"># write synthesized design</span></span><br><span class="line">write_verilog synth.v</span><br></pre></td></tr></table></figure><p>它会生成逻辑上的CPU modules</p> <?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1035px" preserveAspectRatio="none" style="width:443px;height:1035px;background:#fff" version="1.1" viewBox="0 0 443 1035" width="443px" zoomAndPan="magnify" class="kroki">$2<defs/><g><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="47" x="10" y="498.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="20" y="521.5186">Top</text><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="146" x="107" y="20"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="117" y="42.9951">DCombinMemPort</text><path d="M57,516.6719 L67,516.6719 C82,516.6719 82,38.1484 97,38.1484 L107,38.1484 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="138" x="107" y="76.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="117" y="99.292">ICombinMemPort</text><path d="M57,516.6719 L67,516.6719 C82,516.6719 82,94.4453 97,94.4453 L107,94.4453 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="205" x="107" y="132.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185" x="117" y="155.5889">DualPortedCombinMemory</text><path d="M57,516.6719 L67,516.6719 C82,516.6719 82,150.7422 97,150.7422 L107,150.7422 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="112" x="107" y="582.9688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="117" y="605.9639">PipelinedCPU</text><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="104" x="269" y="188.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="279" y="211.8857">StageReg_6</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,207.0391 259,207.0391 L269,207.0391 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="104" x="269" y="245.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="279" y="268.1826">StageReg_5</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,263.3359 259,263.3359 L269,263.3359 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="104" x="269" y="301.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="279" y="324.4795">StageReg_4</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,319.6328 259,319.6328 L269,319.6328 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="104" x="269" y="357.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="279" y="380.7764">StageReg_3</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,375.9297 259,375.9297 L269,375.9297 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="104" x="269" y="414.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="279" y="437.0732">StageReg_2</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,432.2266 259,432.2266 L269,432.2266 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="104" x="269" y="470.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="279" y="493.3701">StageReg_1</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,488.5234 259,488.5234 L269,488.5234 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="88" x="269" y="526.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="279" y="549.667">StageReg</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,544.8203 259,544.8203 L269,544.8203 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="95" x="269" y="582.9688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="279" y="605.9639">HazardUnit</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,601.1172 259,601.1172 L269,601.1172 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="123" x="269" y="639.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="279" y="662.2607">ForwardingUnit</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,657.4141 259,657.4141 L269,657.4141 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="61" x="269" y="695.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="279" y="718.5576">Adder</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,713.7109 259,713.7109 L269,713.7109 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="162" x="269" y="751.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="279" y="774.8545">ImmediateGenerator</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,770.0078 259,770.0078 L269,770.0078 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="46" x="269" y="808.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="279" y="831.1514">ALU</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,826.3047 259,826.3047 L269,826.3047 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="96" x="269" y="864.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="279" y="887.4482">ALUControl</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,882.6016 259,882.6016 L269,882.6016 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="101" x="269" y="920.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="279" y="943.7451">RegisterFile</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,938.8984 259,938.8984 L269,938.8984 " fill="none" style="stroke:#454645;stroke-width:1"/><rect fill="#F1F1F1" height="36.2969" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:1.5" width="70" x="269" y="977.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="279" y="1000.042">Control</text><path d="M219,601.1172 L229,601.1172 C244,601.1172 244,995.1953 259,995.1953 L269,995.1953 " fill="none" style="stroke:#454645;stroke-width:1"/><path d="M57,516.6719 L67,516.6719 C82,516.6719 82,601.1172 97,601.1172 L107,601.1172 " fill="none" style="stroke:#454645;stroke-width:1"/></g></svg><p>最终生成的v文件(netlist)是机器反复优化的产物，虽然仍然是文本，但是编辑将很费劲了，如果强行编辑，这种叫做“<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-hans/%E5%B7%A5%E7%A8%8B%E6%94%B9%E5%8F%98%E5%91%BD%E4%BB%A4">ECO</a>”，并需要FM形式化证明。</p><blockquote><p>当前遇到一个问题，我的Mac版CPU只有一个core在工作，导致真八核只跑了一个核，没找到类似makefile的j8这种参数。同时内存至少给8G，否则后续优化跑不动。</p></blockquote><p>这个文件将上百MB，可以用verdi等商用或者开源工具打开，也可以用<code>show</code>命令渲染，或者用这个<a target="_blank" rel="noopener" href="https://github.com/nturley/netlistsvg">svg项目</a>查看</p><h2>总结</h2><p>上述只是用现成的工具拼接而成的产物</p><ul><li>没有涉及验证、SIMU、EMU等前端流程</li><li>没有涉及DFT、PT、FM等BES流程</li><li>不能只跑Top，而不跑别的Design。</li></ul><p>所以本文只跑了一个入门大概流程。后续还有Place and routing等流程，最终才能交付制造。</p></div><div class="tags"><a class="tag-link" href="/tags/RISC-V/" rel="tag">RISC-V</a></div></section><div class="comments no-print"><noscript>Please enable JavaScript to view comments.</noscript><script async src="https://giscus.app/client.js" data-repo="miao1007/miao1007.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkxMzA1NTY1MDU=" data-category="General" data-category-id="DIC_kwDOB8giWc4COaTx" data-mapping="url" data-reactions-enabled="0" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="en" crossorigin="anonymous"></script></div></div></div><footer class="no-print"><div class="rights"><a href="/feed.xml" rel="external nofollow">RSS</a><span>, Theme </span><a href="https://github.com/gary-Shen/hexo-theme-bear" rel="external nofollow" target="_blank">Curry</a><span>.</span></div></footer></div></body></html>